
/*
 * JustGage - this is work-in-progress, unreleased, unofficial code, so it might not work top-notch :)
 * Check http://www.justgage.com for official releases
 * Licensed under MIT.
 * @author Bojan Djuricic (@Toorshia)
 *
 * lastest update from  March 16, 2014.
*/
JustGage=function(config){var obj=this;if(config===null||config===undefined){console.log("* justgage: Make sure to pass options to the constructor!");return false}var node;if(config.id!==null&&config.id!==undefined){node=document.getElementById(config.id);if(!node){console.log("* justgage: No element with id : %s found",config.id);return false}}else if(config.parentNode!==null&&config.parentNode!==undefined){node=config.parentNode}else{console.log("* justgage: Make sure to pass the existing element id or parentNode to the constructor.");return false}var dataset=node.dataset?node.dataset:{};obj.config={id:config.id,parentNode:obj.kvLookup("parentNode",config,dataset,null),width:obj.kvLookup("width",config,dataset,null),height:obj.kvLookup("height",config,dataset,null),title:obj.kvLookup("title",config,dataset,""),titleFontColor:obj.kvLookup("titleFontColor",config,dataset,"#999999"),value:obj.kvLookup("value",config,dataset,0,"float"),valueFontColor:obj.kvLookup("valueFontColor",config,dataset,"#010101"),symbol:obj.kvLookup("symbol",config,dataset,""),min:obj.kvLookup("min",config,dataset,0,"float"),max:obj.kvLookup("max",config,dataset,100,"float"),humanFriendlyDecimal:obj.kvLookup("humanFriendlyDecimal",config,dataset,0),textRenderer:obj.kvLookup("textRenderer",config,dataset,null),gaugeWidthScale:obj.kvLookup("gaugeWidthScale",config,dataset,1),gaugeColor:obj.kvLookup("gaugeColor",config,dataset,"#edebeb"),label:obj.kvLookup("label",config,dataset,""),labelFontColor:obj.kvLookup("labelFontColor",config,dataset,"#b3b3b3"),shadowOpacity:obj.kvLookup("shadowOpacity",config,dataset,.2),shadowSize:obj.kvLookup("shadowSize",config,dataset,5),shadowVerticalOffset:obj.kvLookup("shadowVerticalOffset",config,dataset,3),levelColors:obj.kvLookup("levelColors",config,dataset,["#a9d70b","#f9c802","#ff0000"],"array",","),startAnimationTime:obj.kvLookup("startAnimationTime",config,dataset,700),startAnimationType:obj.kvLookup("startAnimationType",config,dataset,">"),refreshAnimationTime:obj.kvLookup("refreshAnimationTime",config,dataset,700),refreshAnimationType:obj.kvLookup("refreshAnimationType",config,dataset,">"),donutStartAngle:obj.kvLookup("donutStartAngle",config,dataset,90),valueMinFontSize:obj.kvLookup("valueMinFontSize",config,dataset,16),titleMinFontSize:obj.kvLookup("titleMinFontSize",config,dataset,10),labelMinFontSize:obj.kvLookup("labelMinFontSize",config,dataset,10),minLabelMinFontSize:obj.kvLookup("minLabelMinFontSize",config,dataset,10),maxLabelMinFontSize:obj.kvLookup("maxLabelMinFontSize",config,dataset,10),hideValue:obj.kvLookup("hideValue",config,dataset,false),hideMinMax:obj.kvLookup("hideMinMax",config,dataset,false),hideInnerShadow:obj.kvLookup("hideInnerShadow",config,dataset,false),humanFriendly:obj.kvLookup("humanFriendly",config,dataset,false),noGradient:obj.kvLookup("noGradient",config,dataset,false),donut:obj.kvLookup("donut",config,dataset,false),relativeGaugeSize:obj.kvLookup("relativeGaugeSize",config,dataset,false),counter:obj.kvLookup("counter",config,dataset,false),decimals:obj.kvLookup("decimals",config,dataset,0),customSectors:obj.kvLookup("customSectors",config,dataset,[]),formatNumber:obj.kvLookup("formatNumber",config,dataset,false)};var canvasW,canvasH,widgetW,widgetH,aspect,dx,dy,titleFontSize,titleX,titleY,valueFontSize,valueX,valueY,labelFontSize,labelX,labelY,minFontSize,minX,minY,maxFontSize,maxX,maxY;if(obj.config.value>obj.config.max)obj.config.value=obj.config.max;if(obj.config.value<obj.config.min)obj.config.value=obj.config.min;obj.originalValue=obj.kvLookup("value",config,dataset,-1,"float");if(obj.config.id!==null&&document.getElementById(obj.config.id)!==null){obj.canvas=Raphael(obj.config.id,"100%","100%")}else if(obj.config.parentNode!==null){obj.canvas=Raphael(obj.config.parentNode,"100%","100%")}if(obj.config.relativeGaugeSize===true){obj.canvas.setViewBox(0,0,200,150,true)}if(obj.config.relativeGaugeSize===true){canvasW=200;canvasH=150}else if(obj.config.width!==null&&obj.config.height!==null){canvasW=obj.config.width;canvasH=obj.config.height}else if(obj.config.parentNode!==null){obj.canvas.setViewBox(0,0,200,150,true);canvasW=200;canvasH=150}else{canvasW=getStyle(document.getElementById(obj.config.id),"width").slice(0,-2)*1;canvasH=getStyle(document.getElementById(obj.config.id),"height").slice(0,-2)*1}if(obj.config.donut===true){if(canvasW>canvasH){widgetH=canvasH;widgetW=widgetH}else if(canvasW<canvasH){widgetW=canvasW;widgetH=widgetW;if(widgetH>canvasH){aspect=widgetH/canvasH;widgetH=widgetH/aspect;widgetW=widgetH/aspect}}else{widgetW=canvasW;widgetH=widgetW}dx=(canvasW-widgetW)/2;dy=(canvasH-widgetH)/2;titleFontSize=widgetH/8>10?widgetH/10:10;titleX=dx+widgetW/2;titleY=dy+widgetH/11;valueFontSize=widgetH/6.4>16?widgetH/5.4:18;valueX=dx+widgetW/2;if(obj.config.label!==""){valueY=dy+widgetH/1.85}else{valueY=dy+widgetH/1.7}labelFontSize=widgetH/16>10?widgetH/16:10;labelX=dx+widgetW/2;labelY=valueY+labelFontSize;minFontSize=widgetH/16>10?widgetH/16:10;minX=dx+widgetW/10+widgetW/6.666666666666667*obj.config.gaugeWidthScale/2;minY=labelY;maxFontSize=widgetH/16>10?widgetH/16:10;maxX=dx+widgetW-widgetW/10-widgetW/6.666666666666667*obj.config.gaugeWidthScale/2;maxY=labelY}else{if(canvasW>canvasH){widgetH=canvasH;widgetW=widgetH*1.25;if(widgetW>canvasW){aspect=widgetW/canvasW;widgetW=widgetW/aspect;widgetH=widgetH/aspect}}else if(canvasW<canvasH){widgetW=canvasW;widgetH=widgetW/1.25;if(widgetH>canvasH){aspect=widgetH/canvasH;widgetH=widgetH/aspect;widgetW=widgetH/aspect}}else{widgetW=canvasW;widgetH=widgetW*.75}dx=(canvasW-widgetW)/2;dy=(canvasH-widgetH)/2;titleFontSize=widgetH/8>obj.config.titleMinFontSize?widgetH/10:obj.config.titleMinFontSize;titleX=dx+widgetW/2;titleY=dy+widgetH/6.4;valueFontSize=widgetH/6.5>obj.config.valueMinFontSize?widgetH/6.5:obj.config.valueMinFontSize;valueX=dx+widgetW/2;valueY=dy+widgetH/1.275;labelFontSize=widgetH/16>obj.config.labelMinFontSize?widgetH/16:obj.config.labelMinFontSize;labelX=dx+widgetW/2;labelY=valueY+valueFontSize/2+5;minFontSize=widgetH/16>obj.config.minLabelMinFontSize?widgetH/16:obj.config.minLabelMinFontSize;minX=dx+widgetW/10+widgetW/6.666666666666667*obj.config.gaugeWidthScale/2;minY=labelY;maxFontSize=widgetH/16>obj.config.maxLabelMinFontSize?widgetH/16:obj.config.maxLabelMinFontSize;maxX=dx+widgetW-widgetW/10-widgetW/6.666666666666667*obj.config.gaugeWidthScale/2;maxY=labelY}obj.params={canvasW:canvasW,canvasH:canvasH,widgetW:widgetW,widgetH:widgetH,dx:dx,dy:dy,titleFontSize:titleFontSize,titleX:titleX,titleY:titleY,valueFontSize:valueFontSize,valueX:valueX,valueY:valueY,labelFontSize:labelFontSize,labelX:labelX,labelY:labelY,minFontSize:minFontSize,minX:minX,minY:minY,maxFontSize:maxFontSize,maxX:maxX,maxY:maxY};canvasW,canvasH,widgetW,widgetH,aspect,dx,dy,titleFontSize,titleX,titleY,valueFontSize,valueX,valueY,labelFontSize,labelX,labelY,minFontSize,minX,minY,maxFontSize,maxX,maxY=null;obj.canvas.customAttributes.pki=function(value,min,max,w,h,dx,dy,gws,donut){var alpha,Ro,Ri,Cx,Cy,Xo,Yo,Xi,Yi,path;if(donut){alpha=(1-2*(value-min)/(max-min))*Math.PI;Ro=w/2-w/7;Ri=Ro-w/6.666666666666667*gws;Cx=w/2+dx;Cy=h/1.95+dy;Xo=w/2+dx+Ro*Math.cos(alpha);Yo=h-(h-Cy)-Ro*Math.sin(alpha);Xi=w/2+dx+Ri*Math.cos(alpha);Yi=h-(h-Cy)-Ri*Math.sin(alpha);path="M"+(Cx-Ri)+","+Cy+" ";path+="L"+(Cx-Ro)+","+Cy+" ";if(value>(max-min)/2){path+="A"+Ro+","+Ro+" 0 0 1 "+(Cx+Ro)+","+Cy+" "}path+="A"+Ro+","+Ro+" 0 0 1 "+Xo+","+Yo+" ";path+="L"+Xi+","+Yi+" ";if(value>(max-min)/2){path+="A"+Ri+","+Ri+" 0 0 0 "+(Cx+Ri)+","+Cy+" "}path+="A"+Ri+","+Ri+" 0 0 0 "+(Cx-Ri)+","+Cy+" ";path+="Z ";return{path:path}}else{alpha=(1-(value-min)/(max-min))*Math.PI;Ro=w/2-w/10;Ri=Ro-w/6.666666666666667*gws;Cx=w/2+dx;Cy=h/1.25+dy;Xo=w/2+dx+Ro*Math.cos(alpha);Yo=h-(h-Cy)-Ro*Math.sin(alpha);Xi=w/2+dx+Ri*Math.cos(alpha);Yi=h-(h-Cy)-Ri*Math.sin(alpha);path="M"+(Cx-Ri)+","+Cy+" ";path+="L"+(Cx-Ro)+","+Cy+" ";path+="A"+Ro+","+Ro+" 0 0 1 "+Xo+","+Yo+" ";path+="L"+Xi+","+Yi+" ";path+="A"+Ri+","+Ri+" 0 0 0 "+(Cx-Ri)+","+Cy+" ";path+="Z ";return{path:path}}alpha,Ro,Ri,Cx,Cy,Xo,Yo,Xi,Yi,path=null};obj.gauge=obj.canvas.path().attr({stroke:"none",fill:obj.config.gaugeColor,pki:[obj.config.max,obj.config.min,obj.config.max,obj.params.widgetW,obj.params.widgetH,obj.params.dx,obj.params.dy,obj.config.gaugeWidthScale,obj.config.donut]});obj.level=obj.canvas.path().attr({stroke:"none",fill:getColor(obj.config.value,(obj.config.value-obj.config.min)/(obj.config.max-obj.config.min),obj.config.levelColors,obj.config.noGradient,obj.config.customSectors),pki:[obj.config.min,obj.config.min,obj.config.max,obj.params.widgetW,obj.params.widgetH,obj.params.dx,obj.params.dy,obj.config.gaugeWidthScale,obj.config.donut]});if(obj.config.donut){obj.level.transform("r"+obj.config.donutStartAngle+", "+(obj.params.widgetW/2+obj.params.dx)+", "+(obj.params.widgetH/1.95+obj.params.dy))}obj.txtTitle=obj.canvas.text(obj.params.titleX,obj.params.titleY,obj.config.title);obj.txtTitle.attr({"font-size":obj.params.titleFontSize,"font-weight":"bold","font-family":"Arial",fill:obj.config.titleFontColor,"fill-opacity":"1"});setDy(obj.txtTitle,obj.params.titleFontSize,obj.params.titleY);obj.txtValue=obj.canvas.text(obj.params.valueX,obj.params.valueY,0);obj.txtValue.attr({"font-size":obj.params.valueFontSize,"font-weight":"bold","font-family":"Arial",fill:obj.config.valueFontColor,"fill-opacity":"0"});setDy(obj.txtValue,obj.params.valueFontSize,obj.params.valueY);obj.txtLabel=obj.canvas.text(obj.params.labelX,obj.params.labelY,obj.config.label);obj.txtLabel.attr({"font-size":obj.params.labelFontSize,"font-weight":"normal","font-family":"Arial",fill:obj.config.labelFontColor,"fill-opacity":"0"});setDy(obj.txtLabel,obj.params.labelFontSize,obj.params.labelY);obj.txtMinimum=obj.config.min;if(obj.config.humanFriendly){obj.txtMinimum=humanFriendlyNumber(obj.config.min,obj.config.humanFriendlyDecimal)}else if(obj.config.formatNumber){obj.txtMinimum=formatNumber(obj.config.min)}obj.txtMin=obj.canvas.text(obj.params.minX,obj.params.minY,obj.txtMinimum);obj.txtMin.attr({"font-size":obj.params.minFontSize,"font-weight":"normal","font-family":"Arial",fill:obj.config.labelFontColor,"fill-opacity":obj.config.hideMinMax||obj.config.donut?"0":"1"});setDy(obj.txtMin,obj.params.minFontSize,obj.params.minY);obj.txtMaximum=obj.config.max;if(obj.config.formatNumber){obj.txtMaximum=formatNumber(obj.txtMaximum)}else if(obj.config.humanFriendly){obj.txtMaximum=humanFriendlyNumber(obj.config.max,obj.config.humanFriendlyDecimal)}obj.txtMax=obj.canvas.text(obj.params.maxX,obj.params.maxY,obj.txtMaximum);obj.txtMax.attr({"font-size":obj.params.maxFontSize,"font-weight":"normal","font-family":"Arial",fill:obj.config.labelFontColor,"fill-opacity":obj.config.hideMinMax||obj.config.donut?"0":"1"});setDy(obj.txtMax,obj.params.maxFontSize,obj.params.maxY);var defs=obj.canvas.canvas.childNodes[1];var svg="http://www.w3.org/2000/svg";if(ie!=="undefined"&&ie<9){}else if(ie!=="undefined"){onCreateElementNsReady(function(){obj.generateShadow(svg,defs)})}else{obj.generateShadow(svg,defs)}defs,svg=null;if(obj.config.textRenderer){obj.originalValue=obj.config.textRenderer(obj.originalValue)}else if(obj.config.humanFriendly){obj.originalValue=humanFriendlyNumber(obj.originalValue,obj.config.humanFriendlyDecimal)+obj.config.symbol}else if(obj.config.formatNumber){obj.originalValue=formatNumber(obj.originalValue)+obj.config.symbol}else{obj.originalValue=(obj.originalValue*1).toFixed(obj.config.decimals)+obj.config.symbol}if(obj.config.counter===true){eve.on("raphael.anim.frame."+obj.level.id,function(){var currentValue=obj.level.attr("pki");if(obj.config.textRenderer){obj.txtValue.attr("text",obj.config.textRenderer(Math.floor(currentValue[0])))}else if(obj.config.humanFriendly){obj.txtValue.attr("text",humanFriendlyNumber(Math.floor(currentValue[0]),obj.config.humanFriendlyDecimal)+obj.config.symbol)}else if(obj.config.formatNumber){obj.txtValue.attr("text",formatNumber(Math.floor(currentValue[0]))+obj.config.symbol)}else{obj.txtValue.attr("text",(currentValue[0]*1).toFixed(obj.config.decimals)+obj.config.symbol)}setDy(obj.txtValue,obj.params.valueFontSize,obj.params.valueY);currentValue=null});eve.on("raphael.anim.finish."+obj.level.id,function(){obj.txtValue.attr({text:obj.originalValue});setDy(obj.txtValue,obj.params.valueFontSize,obj.params.valueY)})}else{eve.on("raphael.anim.start."+obj.level.id,function(){obj.txtValue.attr({text:obj.originalValue});setDy(obj.txtValue,obj.params.valueFontSize,obj.params.valueY)})}obj.level.animate({pki:[obj.config.value,obj.config.min,obj.config.max,obj.params.widgetW,obj.params.widgetH,obj.params.dx,obj.params.dy,obj.config.gaugeWidthScale,obj.config.donut]},obj.config.startAnimationTime,obj.config.startAnimationType);obj.txtValue.animate({"fill-opacity":obj.config.hideValue?"0":"1"},obj.config.startAnimationTime,obj.config.startAnimationType);obj.txtLabel.animate({"fill-opacity":"1"},obj.config.startAnimationTime,obj.config.startAnimationType)};JustGage.prototype.kvLookup=function(key,tablea,tableb,defval,datatype,delimiter){var val=defval;var canConvert=false;if(!(key===null||key===undefined)){if(tableb!==null&&tableb!==undefined&&typeof tableb==="object"&&key in tableb){val=tableb[key];canConvert=true}else if(tablea!==null&&tablea!==undefined&&typeof tablea==="object"&&key in tablea){val=tablea[key];canConvert=true}else{val=defval}if(canConvert===true){if(datatype!==null&&datatype!==undefined){switch(datatype){case"int":val=parseInt(val,10);break;case"float":val=parseFloat(val);break;default:break}}}}return val};JustGage.prototype.refresh=function(val,max){var obj=this;var displayVal,color,max=max||null;if(max!==null){obj.config.max=max;obj.txtMaximum=obj.config.max;if(obj.config.humanFriendly){obj.txtMaximum=humanFriendlyNumber(obj.config.max,obj.config.humanFriendlyDecimal)}else if(obj.config.formatNumber){obj.txtMaximum=formatNumber(obj.config.max)}obj.txtMax.attr({text:obj.txtMaximum});setDy(obj.txtMax,obj.params.maxFontSize,obj.params.maxY)}displayVal=val;if(val*1>obj.config.max*1){val=obj.config.max*1}if(val*1<obj.config.min*1){val=obj.config.min*1}color=getColor(val,(val-obj.config.min)/(obj.config.max-obj.config.min),obj.config.levelColors,obj.config.noGradient,obj.config.customSectors);if(obj.config.textRenderer){displayVal=obj.config.textRenderer(displayVal)}else if(obj.config.humanFriendly){displayVal=humanFriendlyNumber(displayVal,obj.config.humanFriendlyDecimal)+obj.config.symbol}else if(obj.config.formatNumber){displayVal=formatNumber((displayVal*1).toFixed(obj.config.decimals))+obj.config.symbol}else{displayVal=(displayVal*1).toFixed(obj.config.decimals)+obj.config.symbol}obj.originalValue=displayVal;obj.config.value=val*1;if(!obj.config.counter){obj.txtValue.attr({text:displayVal});setDy(obj.txtValue,obj.params.valueFontSize,obj.params.valueY)}obj.level.animate({pki:[obj.config.value,obj.config.min,obj.config.max,obj.params.widgetW,obj.params.widgetH,obj.params.dx,obj.params.dy,obj.config.gaugeWidthScale,obj.config.donut],fill:color},obj.config.refreshAnimationTime,obj.config.refreshAnimationType);obj,displayVal,color,max=null};JustGage.prototype.generateShadow=function(svg,defs){var obj=this;var gaussFilter,feOffset,feGaussianBlur,feComposite1,feFlood,feComposite2,feComposite3;gaussFilter=document.createElementNS(svg,"filter");gaussFilter.setAttribute("id","inner-shadow");defs.appendChild(gaussFilter);feOffset=document.createElementNS(svg,"feOffset");feOffset.setAttribute("dx",0);feOffset.setAttribute("dy",obj.config.shadowVerticalOffset);gaussFilter.appendChild(feOffset);feGaussianBlur=document.createElementNS(svg,"feGaussianBlur");feGaussianBlur.setAttribute("result","offset-blur");feGaussianBlur.setAttribute("stdDeviation",obj.config.shadowSize);gaussFilter.appendChild(feGaussianBlur);feComposite1=document.createElementNS(svg,"feComposite");feComposite1.setAttribute("operator","out");feComposite1.setAttribute("in","SourceGraphic");feComposite1.setAttribute("in2","offset-blur");feComposite1.setAttribute("result","inverse");gaussFilter.appendChild(feComposite1);feFlood=document.createElementNS(svg,"feFlood");feFlood.setAttribute("flood-color","black");feFlood.setAttribute("flood-opacity",obj.config.shadowOpacity);feFlood.setAttribute("result","color");gaussFilter.appendChild(feFlood);feComposite2=document.createElementNS(svg,"feComposite");feComposite2.setAttribute("operator","in");feComposite2.setAttribute("in","color");feComposite2.setAttribute("in2","inverse");feComposite2.setAttribute("result","shadow");gaussFilter.appendChild(feComposite2);feComposite3=document.createElementNS(svg,"feComposite");feComposite3.setAttribute("operator","over");feComposite3.setAttribute("in","shadow");feComposite3.setAttribute("in2","SourceGraphic");gaussFilter.appendChild(feComposite3);if(!obj.config.hideInnerShadow){obj.canvas.canvas.childNodes[2].setAttribute("filter","url(#inner-shadow)");obj.canvas.canvas.childNodes[3].setAttribute("filter","url(#inner-shadow)")}gaussFilter,feOffset,feGaussianBlur,feComposite1,feFlood,feComposite2,feComposite3=null};function getColor(val,pct,col,noGradient,custSec){var no,inc,colors,percentage,rval,gval,bval,lower,upper,range,rangePct,pctLower,pctUpper,color;var noGradient=noGradient||custSec.length>0;if(custSec.length>0){for(var i=0;i<custSec.length;i++){if(val>custSec[i].lo&&val<=custSec[i].hi){return custSec[i].color}}}no=col.length;if(no===1)return col[0];inc=noGradient?1/no:1/(no-1);colors=[];for(i=0;i<col.length;i++){percentage=noGradient?inc*(i+1):inc*i;rval=parseInt(cutHex(col[i]).substring(0,2),16);gval=parseInt(cutHex(col[i]).substring(2,4),16);bval=parseInt(cutHex(col[i]).substring(4,6),16);colors[i]={pct:percentage,color:{r:rval,g:gval,b:bval}}}if(pct===0){return"rgb("+[colors[0].color.r,colors[0].color.g,colors[0].color.b].join(",")+")"}for(var j=0;j<colors.length;j++){if(pct<=colors[j].pct){if(noGradient){return"rgb("+[colors[j].color.r,colors[j].color.g,colors[j].color.b].join(",")+")"}else{lower=colors[j-1];upper=colors[j];range=upper.pct-lower.pct;rangePct=(pct-lower.pct)/range;pctLower=1-rangePct;pctUpper=rangePct;color={r:Math.floor(lower.color.r*pctLower+upper.color.r*pctUpper),g:Math.floor(lower.color.g*pctLower+upper.color.g*pctUpper),b:Math.floor(lower.color.b*pctLower+upper.color.b*pctUpper)};return"rgb("+[color.r,color.g,color.b].join(",")+")"}}}}function setDy(elem,fontSize,txtYpos){if((!ie||ie>9)&&elem.node.firstChild.attributes.dy){elem.node.firstChild.attributes.dy.value=0}}function getRandomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}function cutHex(str){return str.charAt(0)=="#"?str.substring(1,7):str}function humanFriendlyNumber(n,d){var p,d2,i,s;p=Math.pow;d2=p(10,d);i=7;while(i){s=p(10,i--*3);if(s<=n){n=Math.round(n*d2/s)/d2+"KMGTPE"[i]}}return n}function formatNumber(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");return parts.join(".")}function getStyle(oElm,strCssRule){var strValue="";if(document.defaultView&&document.defaultView.getComputedStyle){strValue=document.defaultView.getComputedStyle(oElm,"").getPropertyValue(strCssRule)}else if(oElm.currentStyle){strCssRule=strCssRule.replace(/\-(\w)/g,function(strMatch,p1){return p1.toUpperCase()});strValue=oElm.currentStyle[strCssRule]}return strValue}function onCreateElementNsReady(func){if(document.createElementNS!==undefined){func()}else{setTimeout(function(){onCreateElementNsReady(func)},100)}}var ie=function(){var undef,v=3,div=document.createElement("div"),all=div.getElementsByTagName("i");while(div.innerHTML="<!--[if gt IE "+ ++v+"]><i></i><![endif]-->",all[0]);return v>4?v:undef}();
